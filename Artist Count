import pandas as pd
import csv
import matplotlib.pyplot as plt

def extractColumn(columnNumber):       
    # code to read the data
    data = pd.read_csv('spotify-2023.csv', encoding='latin1')
    with open('spotify-2023.csv', 'r') as f:
        csv_reader = csv.reader(f)
        next(csv_reader)  # this line skips the header

        # now we can read the data from any column using the columnNumber parameter
        columnData = []
        for row in csv_reader:
            data = row[columnNumber]
            columnData.append(data)
        return columnData

def mapToInteger(userList):
    mappedList = []
    for item in userList:
        try:
            mappedList.append(int(item))
        except ValueError:
            # If the item cannot be converted to an integer, ignore it
            mappedList.append(-1)
    return mappedList

def createBarChart(title, subtitle, xData, yData, xLabel, yLabel):
    plt.figure(figsize=(10, 6))
    plt.bar(xData, yData, color='skyblue')
    plt.title(title)
    plt.xlabel(xLabel)
    plt.ylabel(yLabel)
    plt.xticks(rotation=45, ha='right')
    plt.grid(axis='y', linestyle='--', alpha=0.7)
    plt.tight_layout()
    plt.show()

# Extracting data for keys and streams
artistData = extractColumn(2)
streamsData = mapToInteger(extractColumn(8))

# Creating a bar chart
createBarChart("Artists Count's Affect on Streams", "Example", artistData, streamsData, "Artist Count", "Streams(million)")
